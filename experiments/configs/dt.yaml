defaults:
  - network: gasse_network_no_head
instances:
  co_class: 'set_covering'
  co_class_kwargs:
    'n_rows': 165
    'n_cols': 230

experiment:
  seed: 0
  device: 'cuda:0'
  path_to_load_imitation_data: '/scratch/datasets/retro_branching/strong_branching'
  path_to_save: '/scratch/datasets/retro_branching'
  branching: 'explore_then_strong_branch' # 'pure_strong_branch' 'explore_then_strong_branch'
  max_steps: null # None 3
  num_samples: 120000
  num_epochs: 1000
  
  
learner:
  imitation_target: 'expert_actions' # 'expert_scores' 'expert_score' 'expert_actions' 'expert_bipartite_ranking'
  loss_function: 'cross_entropy' # mean_squared_error cross_entropy jensen_shannon_distance kullback_leibler_divergence
  lr: 0.0001
  epoch_log_frequency: 1
  checkpoint_frequency: 1
  name: 'supervised_learner'
  

DataConfig:
  context_length: 5 #10
  data_path : '/home/liutf/datas/pure_strong_branch/set_covering/max_steps_None/set_covering_n_rows_165_n_cols_230/samples/samples_1/'
  #'/home/liutf/datas/pure_strong_branch/set_covering/max_steps_None/set_covering_n_rows_500_n_cols_1000/samples/samples_1/'
  #'/home/liutf/code/retro_branching_offline/pure_strong_branch/set_covering/max_steps_None/set_covering_n_rows_500_n_cols_1000/samples/samples_3'
  max_epochs: 100000000 # when laod can load 3200 epochs limit by mem. use 32 for fast load data and debug

GPTConfig:
  embd_pdrop: 0.1
  resid_pdrop: 0.1
  attn_pdrop: 0.1
  n_layer: 1 # default 6
  n_head: 1  # default 8
  n_embd: 256 
  model_type: reward_conditioned
  vocab_size: 230
  jump_attn: False
  use_atten: True


TrainerConfig:
  max_epochs: 1000
  batch_size: 64 # default 128
  learning_rate: 5e-5 #6e-4
  betas: [0.9, 0.95]
  grad_norm_clip: 1.0
  weight_decay: 0.1 # only applied on matmul weights
  lr_decay: False 
  warmup_tokens: 10240 #512*20 
  num_workers: 4
  seed: 123
  model_type: reward_conditioned
  game: scip
  max_pad_size: 230
  ckpt_path: '/home/liutf/code/retro_branching_offline/dt_out/'
  need_get_return: False
  save_checkpoint: False

ValidConfig:
  threshold_difficulty: null
  max_steps: 10000000000
  max_steps_agent: null
  overwrite: True
  observation_function: 'default'
  information_function: 'default'
  reward_function: 'default'
  scip_params: 'gasse_2019'